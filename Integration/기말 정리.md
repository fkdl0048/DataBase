# DataBase

## DataBase Indexes

과제 B트리: 해쉬와 B트리를 합친 구조  

해쉬로 접근하여 B트리로 정렬된 데이터를 찾는다.

### Motivation

- 데이터베이스에서 데이터를 찾는 방법
  - Full Scan: 모든 데이터를 순차적으로 읽는 방법
  - Index를 이용한 검색

*릴레이션에는 순서가 없기 때문에 그냥 id 4를 찾는다고 4번째로 접근하면 안된다.*

### Index

- 데이터베이스에서 검색 속도를 높이기 위해 사용하는 자료구조
  - Hash index: 빠른 검색을 위해 해쉬 테이블을 사용
  - Ordered index: 검색과 정렬을 위해 B+ tree를 사용

### Binary Search Tree

- 이진 탐색 트리
- 데이터를 추가하거나 삭제할 때마다 트리의 균형을 맞추는 작업이 필요하다.

![image](https://github.com/fkdl0048/ToDo/assets/84510455/0b3c4b6c-5840-4d56-84a6-9870d10c8854)

### B Tree

#### 탐색과정

- 루트 노드부터 시작
- 노드에 있는 키 값과 찾고자 하는 키 값을 비교
- 찾고자 하는 키 값이 더 크면 오른쪽 자식 노드로 이동
- 찾고자 하는 키 값이 더 작으면 왼쪽 자식 노드로 이동
- 찾고자 하는 키 값을 찾을 때까지 반복

![image](https://github.com/fkdl0048/ToDo/assets/84510455/67acaaef-a62a-42ea-8e6c-389c9549656a)

#### 삽입과정

- 루트 노드부터 시작
- 노드에 있는 키 값과 삽입하려는 키 값을 비교
- 삽입하려는 키 값이 더 크면 오른쪽 자식 노드로 이동
- 삽입하려는 키 값이 더 작으면 왼쪽 자식 노드로 이동
- 삽입하려는 키 값을 찾을 때까지 반복
- 찾으면 해당 노드에 삽입
- 노드에 키 값이 가득 차면 노드를 분할
- 분할된 노드의 중간 값은 부모 노드로 이동
- 부모 노드에 키 값이 가득 차면 부모 노드를 분할
- 루트 노드까지 반복

![image](https://github.com/fkdl0048/DataBase/assets/84510455/d454ab24-2c5f-40e0-92be-cf9a6cb10f82)

#### 삭제과정

- 루트 노드부터 시작
- 노드에 있는 키 값과 삭제하려는 키 값을 비교
- 삭제하려는 키 값이 더 크면 오른쪽 자식 노드로 이동
- 삭제하려는 키 값이 더 작으면 왼쪽 자식 노드로 이동
- 삭제하려는 키 값을 찾을 때까지 반복
- 찾으면 해당 노드에서 삭제
- 삭제된 노드가 리프 노드가 아니면
  - 왼쪽 자식 노드에서 가장 큰 값 또는 오른쪽 자식 노드에서 가장 작은 값을 삭제된 노드에 삽입
  - 삽입된 노드가 가득 차면 노드를 분할
  - 분할된 노드의 중간 값은 부모 노드로 이동
  - 부모 노드에 키 값이 가득 차면 부모 노드를 분할
  - 루트 노드까지 반복
- 삭제된 노드가 리프 노드이면
- 노드에 키 값이 최소 개수보다 작으면
- 형제 노드에서 키 값을 빌려온다.
- 형제 노드에서 키 값을 빌려올 수 없으면
- 부모 노드와 형제 노드를 합친다.
- 루트 노드까지 반복

![Image](https://github.com/fkdl0048/ToDo/assets/84510455/7c7a8096-ade2-445e-839f-8aab164965ce)

#### 높이 증명

- 노드의 최대 키 값 개수가 m개일 때
- 높이가 h일 때 최대 노드 개수는 1 + m + m^2 + ... + m^h
- 높이가 h일 때 최소 노드 개수는 1 + 2 + 2^2 + ... + 2^h
- 높이가 h일 때 최대 키 값 개수는 m^h
- 높이가 h일 때 최소 키 값 개수는 2^h
- 높이가 h일 때 최대 키 값 개수는 최소 키 값 개수의 m배
- 높이가 h일 때 최소 노드 개수는 최대 노드 개수의 1/m배

